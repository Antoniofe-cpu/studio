{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/watch-card.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const WatchCard = registerClientReference(\n    function() { throw new Error(\"Attempted to call WatchCard() from the server but WatchCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/watch-card.tsx <module evaluation>\",\n    \"WatchCard\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,YAAY,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,+DACA","debugId":null}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/watch-card.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const WatchCard = registerClientReference(\n    function() { throw new Error(\"Attempted to call WatchCard() from the server but WatchCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/watch-card.tsx\",\n    \"WatchCard\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,YAAY,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,2CACA","debugId":null}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 166, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firebase/config.ts"],"sourcesContent":["\nimport { initializeApp, getApps, getApp, type FirebaseApp } from 'firebase/app';\nimport { getAuth, type Auth } from 'firebase/auth';\nimport { getFirestore, type Firestore } from 'firebase/firestore';\n\n// Your web app's Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\nconst firebaseConfig = {\n  apiKey: \"AIzaSyBsup1LANccRepTNF0Y1CoBcfMjnqZGkyw\",\n  authDomain: \"watchgraph-a91fd.firebaseapp.com\",\n  projectId: \"watchgraph-a91fd\",\n  storageBucket: \"watchgraph-a91fd.firebasestorage.app\",\n  messagingSenderId: \"984650741137\",\n  appId: \"1:984650741137:web:861fec7023fe4afbe5d630\",\n  measurementId: \"G-8KZVYL1TGD\"\n};\n\n// Initialize Firebase\nlet app: FirebaseApp;\nif (!getApps().length) {\n  app = initializeApp(firebaseConfig);\n} else {\n  app = getApp();\n}\n\nconst auth: Auth = getAuth(app);\nconst db: Firestore = getFirestore(app);\n\nexport { app, auth, db };\n"],"names":[],"mappings":";;;;;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;AAEA,wCAAwC;AACxC,mEAAmE;AACnE,MAAM,iBAAiB;IACrB,QAAQ;IACR,YAAY;IACZ,WAAW;IACX,eAAe;IACf,mBAAmB;IACnB,OAAO;IACP,eAAe;AACjB;AAEA,sBAAsB;AACtB,IAAI;AACJ,IAAI,CAAC,CAAA,GAAA,oLAAA,CAAA,UAAO,AAAD,IAAI,MAAM,EAAE;IACrB,MAAM,CAAA,GAAA,oLAAA,CAAA,gBAAa,AAAD,EAAE;AACtB,OAAO;IACL,MAAM,CAAA,GAAA,oLAAA,CAAA,SAAM,AAAD;AACb;AAEA,MAAM,OAAa,CAAA,GAAA,yOAAA,CAAA,UAAO,AAAD,EAAE;AAC3B,MAAM,KAAgB,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 207, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firebase/firestore-service.ts"],"sourcesContent":["\nimport { collection, getDocs, query, orderBy, where, Timestamp, type QueryConstraint } from 'firebase/firestore';\nimport { db } from './config';\nimport type { WatchDeal, DealLabel } from '@/lib/types';\n\nconst COLLECTION_NAME = 'deals'; \n\ninterface GetWatchDealsParams {\n  sortBy?: 'aiScore' | 'listingPrice';\n  order?: 'asc' | 'desc';\n  brand?: string;\n  // Add more filter/sort parameters here as needed\n}\n\nexport async function getWatchDealsFromFirestore(params?: GetWatchDealsParams): Promise<WatchDeal[]> {\n  try {\n    const queryConstraints: QueryConstraint[] = [];\n\n    // Filtering\n    if (params?.brand) {\n      queryConstraints.push(where('brand', '==', params.brand));\n    }\n\n    // Sorting\n    const sortBy = params?.sortBy || 'aiScore'; // Default sort by aiScore\n    const order = params?.order || 'desc';     // Default order desc\n\n    // Firestore requires the first orderBy field to match the field in an inequality filter if one exists.\n    // For simple equality filters like 'brand', and a different orderBy field, it's generally fine.\n    // If we add range filters (e.g., price range) later, we might need to adjust or add composite indexes.\n    queryConstraints.push(orderBy(sortBy, order));\n    \n    // If sorting by something other than aiScore, and aiScore is not the primary sort,\n    // you might want a secondary sort to ensure consistent ordering for items with the same primary sort value.\n    // For example, if sorting by price, then by aiScore:\n    if (sortBy !== 'aiScore') {\n      queryConstraints.push(orderBy('aiScore', 'desc')); // Secondary sort\n    }\n\n\n    console.log(`Fetching data from '${COLLECTION_NAME}' collection with params:`, params);\n    const dealsCollectionRef = collection(db, COLLECTION_NAME);\n    const q = query(dealsCollectionRef, ...queryConstraints);\n    \n    const querySnapshot = await getDocs(q);\n    \n    if (querySnapshot.empty) {\n      console.log(\"No documents found in the collection with the given criteria.\");\n      return [];\n    }\n\n    const deals: WatchDeal[] = querySnapshot.docs.map((doc) => {\n      const data = doc.data();\n      \n      let lastUpdatedString: string;\n      if (data.lastUpdated instanceof Timestamp) {\n        lastUpdatedString = data.lastUpdated.toDate().toISOString();\n      } else if (typeof data.lastUpdated === 'string') {\n        lastUpdatedString = data.lastUpdated;\n      } else if (typeof data.lastUpdated === 'object' && data.lastUpdated?.seconds) {\n        lastUpdatedString = new Date(data.lastUpdated.seconds * 1000).toISOString();\n      } else {\n        lastUpdatedString = new Date().toISOString();\n      }\n\n      const deal: WatchDeal = {\n        id: doc.id,\n        imageUrl: data.imageUrl || 'https://placehold.co/600x450.png',\n        brand: data.brand || 'Unknown Brand',\n        model: data.model || 'Unknown Model',\n        referenceNumber: data.referenceNumber || 'N/A',\n        listingPrice: typeof data.listingPrice === 'number' ? data.listingPrice : 0,\n        marketPrice: typeof data.marketPrice === 'number' ? data.marketPrice : 0,\n        retailPrice: typeof data.retailPrice === 'number' ? data.retailPrice : undefined,\n        estimatedMarginPercent: typeof data.estimatedMarginPercent === 'number' ? data.estimatedMarginPercent : 0,\n        aiScore: typeof data.aiScore === 'number' ? data.aiScore : 0,\n        dealLabel: (data.dealLabel as DealLabel) || 'üëç OK',\n        tags: Array.isArray(data.tags) ? data.tags : [],\n        sourceUrl: data.sourceUrl || '#',\n        description: data.description || '',\n        condition: data.condition || undefined,\n        demand: data.demand,\n        rarity: data.rarity,\n        risk: data.risk,\n        location: data.location,\n        lastUpdated: lastUpdatedString,\n      };\n      const validDealLabels: DealLabel[] = ['üî• Affare', 'üëç OK', '‚ùå Fuori Prezzo'];\n      if (!validDealLabels.includes(deal.dealLabel)) {\n        deal.dealLabel = 'üëç OK';\n      }\n      return deal;\n    });\n\n    console.log(`Successfully fetched and mapped ${deals.length} deals.`);\n    return deals;\n  } catch (error) {\n    console.error(\"Error fetching watch deals from Firestore:\", error);\n    return [];\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 301, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/filters/deal-filters.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const DealFilters = registerClientReference(\n    function() { throw new Error(\"Attempted to call DealFilters() from the server but DealFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/filters/deal-filters.tsx <module evaluation>\",\n    \"DealFilters\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,cAAc,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,yEACA","debugId":null}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/filters/deal-filters.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const DealFilters = registerClientReference(\n    function() { throw new Error(\"Attempted to call DealFilters() from the server but DealFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/filters/deal-filters.tsx\",\n    \"DealFilters\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,cAAc,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,qDACA","debugId":null}},
    {"offset": {"line": 329, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 339, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/page.tsx"],"sourcesContent":["\nimport type { WatchDeal } from '@/lib/types';\nimport { WatchCard } from '@/components/watch-card';\nimport { getWatchDealsFromFirestore } from '@/lib/firebase/firestore-service';\nimport { DealFilters } from '@/components/filters/deal-filters'; \n\n// The page becomes an async Server Component\nexport default async function HomePage({\n  searchParams,\n}: {\n  searchParams?: {\n    sortBy?: 'aiScore' | 'listingPrice';\n    order?: 'asc' | 'desc';\n    brand?: string;\n    // Add other expected searchParams types here\n  };\n}) {\n  // Extract filter/sort parameters from searchParams\n  const sortBy = searchParams?.sortBy;\n  const order = searchParams?.order;\n  const brand = searchParams?.brand;\n\n  // Data is fetched on the server with the applied filters/sorting\n  const deals: WatchDeal[] = await getWatchDealsFromFirestore({\n    sortBy,\n    order,\n    brand,\n  });\n\n  return (\n    <div className=\"space-y-8\">\n      <section className=\"text-center py-8 bg-card rounded-lg shadow-md\">\n        <h1 className=\"text-4xl font-bold font-headline text-primary mb-2\">WatchFinder AI</h1>\n        <p className=\"text-xl text-muted-foreground\">\n          Trova il vero affare. Ogni giorno. Analisi di mercato e suggerimenti intelligenti.\n        </p>\n      </section>\n\n      {/* Filter and Sort UI Component */}\n      <DealFilters \n        initialSortBy={sortBy}\n        initialOrder={order}\n        initialBrand={brand}\n      />\n\n      <section className=\"p-4 sm:p-6 bg-card rounded-lg shadow-md\">\n        <h2 className=\"text-2xl font-semibold mb-6 text-center\">\n          {brand ? `Live Deals for ${brand}` : 'Live Deals from Firestore'}\n          {sortBy && order && ` (Sorted by ${sortBy} ${order})`}\n        </h2>\n        \n        {deals.length > 0 ? (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n            {deals.map((deal) => (\n              <WatchCard key={deal.id} deal={deal} />\n            ))}\n          </div>\n        ) : (\n          <div className=\"text-center py-10\">\n            <p className=\"text-xl text-muted-foreground\">\n              No deals found matching your criteria.\n            </p>\n            <p className=\"text-sm text-muted-foreground\">\n              Please check if data exists in the 'deals' collection in Firestore\n              and that your Firestore security rules allow read access.\n              Also, check the server console logs for more details.\n            </p>\n          </div>\n        )}\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;;;;AAGe,eAAe,SAAS,EACrC,YAAY,EAQb;IACC,mDAAmD;IACnD,MAAM,SAAS,cAAc;IAC7B,MAAM,QAAQ,cAAc;IAC5B,MAAM,QAAQ,cAAc;IAE5B,iEAAiE;IACjE,MAAM,QAAqB,MAAM,CAAA,GAAA,8IAAA,CAAA,6BAA0B,AAAD,EAAE;QAC1D;QACA;QACA;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAQ,WAAU;;kCACjB,8OAAC;wBAAG,WAAU;kCAAqD;;;;;;kCACnE,8OAAC;wBAAE,WAAU;kCAAgC;;;;;;;;;;;;0BAM/C,8OAAC,gJAAA,CAAA,cAAW;gBACV,eAAe;gBACf,cAAc;gBACd,cAAc;;;;;;0BAGhB,8OAAC;gBAAQ,WAAU;;kCACjB,8OAAC;wBAAG,WAAU;;4BACX,QAAQ,CAAC,eAAe,EAAE,OAAO,GAAG;4BACpC,UAAU,SAAS,CAAC,YAAY,EAAE,OAAO,CAAC,EAAE,MAAM,CAAC,CAAC;;;;;;;oBAGtD,MAAM,MAAM,GAAG,kBACd,8OAAC;wBAAI,WAAU;kCACZ,MAAM,GAAG,CAAC,CAAC,qBACV,8OAAC,mIAAA,CAAA,YAAS;gCAAe,MAAM;+BAAf,KAAK,EAAE;;;;;;;;;6CAI3B,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAE,WAAU;0CAAgC;;;;;;0CAG7C,8OAAC;gCAAE,WAAU;0CAAgC;;;;;;;;;;;;;;;;;;;;;;;;AAUzD","debugId":null}}]
}